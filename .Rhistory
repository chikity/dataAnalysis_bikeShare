library(tidyverse)
read.csv("202106-divvy-tripdata.csv")
read.csv("divvy-tripdata/202106-divvy-tripdata.csv")
data <- read.csv("divvy-tripdata/202106-divvy-tripdata.csv")
head(data)
list.files(path = "divvy-tripdata")
for (i in filenames){
name <- gsub("-",".",i)
name <- gsub(".csv","",name)
i <- paste(".\\",i,sep="")
assign(name,read.csv(i, header=FALSE)
}
}
assign(name,read.csv(i, header=FALSE)}
for (i in filenames) {
name <- gsub("-",".",i)
name <- gsub(".csv","",name)
i <- paste(".\\",i,sep="")
assign(name,read.csv(i, header=FALSE)
}
filenames <- list.files(path = "divvy-tripdata")
for (i in filenames) {
name <- gsub("-",".",i)
name <- gsub(".csv","",name)
i <- paste(".\\",i,sep="")
assign(name,read.csv(i, header=FALSE)
}
for (i in filenames) {
name <- gsub("-",".",i)
name <- gsub(".csv","",name)
i <- paste(".\\",i,sep="")
assign(name,read.csv(i, header=FALSE)
}
for (i in filenames) {
name <- gsub("-",".",i)
name <- gsub(".csv","",name)
i <- paste(".\\",i,sep="")
assign(name,read.csv(i, header=FALSE))
}
?paste
for (i in filenames) {
name <- gsub("-",".",i)
name <- gsub(".csv","",name)
i <- paste("",i,sep="")
assign(name,read.csv(i, header=FALSE))
}
# i <- paste("",i,sep="")
assign(name,read.csv(i, header=FALSE))
i <- paste(".\\",i,sep="")
assign(name,read.csv(i, header=FALSE))
?assign
assign(name, read.csv(i, header=FALSE))
All <- lapply(filenames,function(i){
i <- paste(".\\",i,sep="")
read.csv(i, header=FALSE)
})
filenames <- gsub("-","_",filenames)
names(All) <- gsub(".csv","",filenames)
All <- lapply(filenames,function(i){
i <- paste(".\\",i,sep="")
read.csv(i, header=FALSE)
})
i <- paste(".\\",i,sep="")
All <- lapply(filenames,function(i){
i <- paste(".\\",i,sep="")
read.csv(i, header=FALSE)
})
All <- lapply(filenames, function(i) {
i <- paste(".\\",i,sep="")
read.csv(i, header=FALSE)
})
all_df <- lapply(filenames, function(i) {
i <- paste(".\\",i,sep="")
read.csv(i, header=FALSE)
})
filenames <- list.files(path = "./divvy-tripdata/")
all_df <- lapply(filenames, function(i) {
i <- paste(".\\",i,sep="")
read.csv(i, header=FALSE)
})
filenames <- gsub("-","_",filenames)
names(all_df) <- gsub(".csv","",filenames)
all_df <- lapply(filenames, function(i) {
i <- paste(".\\",i,sep="")
read.csv(i, header=FALSE)
})
filenames <- list.files(path = "./divvy-tripdata/")
filenames
for (i in filenames) {
name <- gsub("-",".",i)
name <- gsub(".csv","",name)
i <- paste(".\\",i,sep="")
assign(name, read.csv(i, header=FALSE))
}
setwd("~/Documents/R Programming/bikeShare")
filenames <- list.files(path = "./divvy-tripdata/")
for (i in filenames) {
name <- gsub("-",".",i)
name <- gsub(".csv","",name)
i <- paste(".\\",i,sep="")
assign(name, read.csv(i, header=FALSE))
}
path <- "./divvy-tripdata/"
filenames <- list.files(path = path)
for (i in filenames) {
name <- gsub("-",".",i)
name <- gsub(".csv","",name)
i <- paste(".\\",i,sep="")
assign(name, read.csv(i, header=FALSE))
}
for (i in filenames) {
name <- gsub("-",".",i)
name <- gsub(".csv","",name)
i <- paste(path,i,sep="")
assign(name, read.csv(i, header=FALSE))
}
## Into a list
all_df <- lapply(filenames, function(i) {
i <- paste(path,i,sep="")
read.csv(i, header=FALSE)
})
filenames <- gsub("-","_",filenames)
names(all_df) <- gsub(".csv","",filenames)
View(all_df)
glimpse(all_df$`202106_divvy_tripdata`)
gc()
gc()
library(tidyverse)
library(janitor)
# Loading the data
path <- "./divvy-tripdata/"
filenames <- list.files(path = path)
## Into a list
all_df <- lapply(filenames, function(i) {
i <- paste(path,i,sep="")
read.csv(i, header=FALSE)
})
filenames <- gsub("-","_",filenames)
names(all_df) <- gsub(".csv","",filenames)
clean_names(all_df)
View(all_df)
View(all_df)
?reduce
joined_df <- all_df %>%
reduce()
joined_df <- all_df %>%
reduce(full_join)
View(all_df)
View(all_df)
View(joined_df)
joined_df[1,]
joined_df[1,]
joined_df[2,]
joined_df[1,]
?rename
?rows_delete
joined_df %>% slice(-1)
joined_df <- all_df %>%
reduce(full_join) %>%
rename(joined_df[1,]) %>%
slice(-1)
joined_df <- joined_df %>%
rename(joined_df[1,]) %>%
slice(-1)
joined_df[1,]
joined_df <- joined_df %>%
rename(joined_df[1,]) %>%
slice(-1)
df <- joined_df %>%
rename(joined_df[1,]) %>%
slice(-1)
joined_df %>% rename(joined_df[1,])
names(joined_df)
names(joined_df) <- joined_df[1,])
names(joined_df) <- joined_df[1,]
names(joined_df)
joined_df[1,]
df <- joined_df %>%
slice(-1)
?slice
titles <- joined_df[1,]
View(titles)
as.character(as.vector(joined_df[1,]))
joined_df <- all_df %>%
reduce(full_join) %>%
rename(as.character(as.vector(joined_df[1,]))) %>%
slice(-1)
df <- joined_df %>%
rename(as.character(as.vector(joined_df[1,]))) %>%
slice(-1)
as.character(as.vector(joined_df[1,]))
df <- joined_df %>%
rename(names(joined_df) = as.character(as.vector(joined_df[1,]))) %>%
slice(-1)
View(titles)
View(joined_df)
View(df)
View(joined_df)
View(df)
colnames(df)
df %>%
mutate(ride_length = ended_at-started_at, .after = ended_at)
glimpse(df)
as.Date("2021-06-13 14:31:28")
library(janitor)
library(lubridate)
ymd_hms("2021-06-13 14:31:28")
df_clean <- as.tibble(df)
df_clean <- as_tibble(df)
View(df_clean)
colnames(df)
df_clean <- as_tibble(df) %>%
ymd_hms(started_at)
df_clean <- as_tibble(df) %>%
ymd_hms(started_at)
df_clean <- as_tibble(df) %>%
ymd_hms('started_at')
done
df_clean
df_clean <- df %>%
ymd_hms(started_at)
df_clean <- df %>%
ymd_hms(started_at)
df_clean <- as_tibble(df) %>%
ymd_hms(started_at)
df_clean <- as_tibble(df) %>%
ymd_hms('started_at')
View(df_clean)
df_clean <- as_tibble(df) %>%
ymd_hms(df$started_at) %>%
ymd_hms(df$ended_at)
df_clean <- df %>%
ymd_hms(started_at) %>%
ymd_hms(ended_at)
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at))
glimpse(df_clean)
as.double("-41")
# Cleaning
## Converting to correct data types
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
as_tibble()
2021-06-13 14:34:11-2021-06-13 14:31:28
'2021-06-13 14:34:11'-'2021-06-13 14:31:28'
difftime('2021-06-13 14:34:11', '2021-06-13 14:31:28')
as_tibble()
# Cleaning
## Converting to correct data types
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
mutate(ride_length = difftime(ended_at, started_at), .after = ended_at) %>%
as_tibble()
as_hms(difftime('2021-06-13 14:34:11', '2021-06-13 14:31:28'))
hms(difftime('2021-06-13 14:34:11', '2021-06-13 14:31:28'))
parse_time(difftime('2021-06-13 14:34:11', '2021-06-13 14:31:28'))
parse_date_time(difftime('2021-06-13 14:34:11', '2021-06-13 14:31:28'))
library(hms)
as_hms(difftime('2021-06-13 14:34:11', '2021-06-13 14:31:28'))
# Cleaning
## Converting to correct data types
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
mutate(ride_length = as_hms(difftime(ended_at, started_at)), .after = ended_at) %>%
as_tibble()
df_clean %>% summarise(mean(ride_length))
df_clean %>% summarise(mean(ride_length)/60)
df_clean %>% summarise(as_double(mean(ride_length))/60)
head(df_clean)
df_clean %>% summarise(as_hms(mean(ride_length)))
df_clean %>% group_by(member_casual) %>% summarise(as_hms(mean(ride_length)))
# Analysis
## Getting average amount of time different rider types ride
df_clean %>% group_by(member_casual) %>% summarise(as_hms(mean(ride_length)))
# Analysis
## Getting average amount of time different rider types ride
df_clean %>% group_by(member_casual) %>% summarise(as.duration(mean(ride_length)))
# Analysis
## Getting average amount of time different rider types ride
df_clean %>% group_by(member_casual) %>% summarise(as.duration(round(mean(ride_length)),2))
# Analysis
## Getting average amount of time different rider types ride
df_clean %>% group_by(member_casual) %>% summarise(as.duration(round(mean(ride_length))))
# Analysis
## Getting average amount of time different rider types ride
df_stats <- df_clean %>%
group_by(member_casual) %>%
mutate(mean = summarise(as.duration(round(mean(ride_length))))) %>%
mutate(max = summarise(max(ride_length)))
# Analysis
## Getting average amount of time different rider types ride
df_stats <- df_clean %>%
group_by(member_casual) %>%
summarise(as.duration(round(mean(ride_length)))) %>%
summarise(max(ride_length))
# Analysis
## Getting average amount of time different rider types ride
df_stats <- df_clean %>%
group_by(member_casual) %>%
summarise(as.duration(round(mean(ride_length))))
View(df_stats)
?summarise
# Analysis
## Getting average amount of time different rider types ride
df_stats <- df_clean %>%
group_by(member_casual) %>%
summarise(mean = as.duration(round(mean(ride_length))), max(ride_length))
# Analysis
## Getting average amount of time different rider types ride
df_stats <- df_clean %>%
group_by(member_casual) %>%
summarise(mean = as.duration(round(mean(ride_length))), max = as.duration(round(max(ride_length))), min = as.duration(round(min(ride_length))))
# Cleaning
## Converting to correct data types
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
mutate(ride_length = as_hms(difftime(ended_at, started_at)), .after = ended_at) %>%
filter(is.na(names(df))) %>%
as_tibble()
filter(is.na(names(start_lat)) %>%
# Cleaning
## Converting to correct data types
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
mutate(ride_length = as_hms(difftime(ended_at, started_at)), .after = ended_at) %>%
filter(is.na(start_lat)) %>%
as_tibble()
# Cleaning
## Converting to correct data types, removing entries with NA
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
mutate(ride_length = as_hms(difftime(ended_at, started_at)), .after = ended_at) %>%
filter(is.na(start_lat)) %>%
as_tibble()
colnames(df)
# Cleaning
## Converting to correct data types, removing entries with NA
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
mutate(ride_length = as_hms(difftime(ended_at, started_at)), .after = ended_at) %>%
remove_empty_rows(start_lat) %>%
as_tibble()
# Cleaning
## Converting to correct data types, removing entries with NA
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
mutate(ride_length = as_hms(difftime(ended_at, started_at)), .after = ended_at) %>%
remove_empty_rows() %>%
as_tibble()
# Cleaning
## Converting to correct data types, removing entries with NA
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
mutate(ride_length = as_hms(difftime(ended_at, started_at)), .after = ended_at) %>%
remove_empty() %>%
as_tibble()
df_clean %>% remove_empty(start_lat)
df_clean %>% remove_empty(which = start_lat)
df_clean %>% remove_empty(which %in% start_lat)
is.na(df_clean)
na.omit(df_clean)
# Cleaning
## Converting to correct data types, removing entries with NA
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
mutate(ride_length = as_hms(difftime(ended_at, started_at)), .after = ended_at) %>%
remove_empty(which = c("rows", "cols")) %>%
na.omit() %>%
as_tibble()
# Analysis
## Getting average amount of time different rider types ride
df_stats_new <- df_clean %>%
group_by(member_casual) %>%
summarise(mean = as.duration(round(mean(ride_length))),
max = as.duration(round(max(ride_length))),
min = as.duration(round(min(ride_length)))
)
View(df_stats_new)
gc()
gc()
df_quantile <- df_clean %>%
group_by(member_casual) %>%
summarise(q2 = as.duration(quantile(ride_length, 0.25)),
q3 = as.duration(quantile(ride_length, 0.5)),
q4 = as.duration(quantile(ride_length, 0.75)),
iqr = as.duration(IQR(ride_length)),
lower = q2-1.5*iqr,
min = as.duration(round(min(ride_length))),
upper = q4+1.5*iqr,
max = as.duration(round(max(ride_length)))
)
source("~/Documents/R Programming/bikeShare/data_exploration.R", echo=TRUE)
library(tidyverse)
library(janitor)
library(lubridate)
library(hms)
# Loading the data
path <- "./divvy-tripdata/"
filenames <- list.files(path = path)
all_df <- lapply(filenames, function(i) {
i <- paste(path,i,sep="")
read.csv(i, header=FALSE)
})
filenames <- gsub("-","_",filenames)
names(all_df) <- gsub(".csv","",filenames)
joined_df <- all_df %>%
reduce(full_join)
# Renaming the data frame
## reduce() function renamed the columns with some place holder values and placed the actual names into the first row of the data frame.
names(joined_df) <- joined_df[1,]
df <- joined_df %>%
slice(-1)
glimpse(df)
## Converting to correct data types, removing entries with NA
df_clean <- df %>%
mutate(started_at = ymd_hms(started_at)) %>%
mutate(ended_at = ymd_hms(ended_at)) %>%
mutate(start_lat = as.double(start_lat)) %>%
mutate(start_lat = as.double(start_lng)) %>%
mutate(start_lat = as.double(end_lat)) %>%
mutate(start_lat = as.double(end_lng)) %>%
mutate(ride_length = as_hms(difftime(ended_at, started_at)), .after = ended_at) %>%
remove_empty(which = c("rows", "cols")) %>%
na.omit() %>%
filter(started_at<=ended_at) %>% # remove cases where end time is somehow before the start time
as_tibble()
## Getting average amount of time different rider types ride
df_stats <- df_clean %>%
group_by(member_casual) %>%
summarise(mean = as.duration(round(mean(ride_length))),
max = as.duration(round(max(ride_length))),
min = as.duration(round(min(ride_length))),
sd = as.duration(round(sd(ride_length))),
median = as.duration(round(median(ride_length)))
) %>%
as_tibble()
glimpse(df)
library(tidyverse)
library(janitor)
library(lubridate)
library(hms)
# Loading the data
path <- "./divvy-tripdata/"
filenames <- list.files(path = path)
all_df <- lapply(filenames, function(i) {
i <- paste(path,i,sep="")
read.csv(i, header=FALSE)
})
filenames <- gsub("-","_",filenames)
names(all_df) <- gsub(".csv","",filenames)
joined_df <- all_df %>%
reduce(full_join)
---
title: "Exploring the data"
author: "Chi Kit Yeung"
output: html_notebook
---
# Answering the Question: In what ways do members and casual riders use Divvy bikes differently?
## Guiding questions
View(df_quantile)
